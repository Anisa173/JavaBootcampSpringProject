CREATE TABLE `user` (
  `id` int NOT NULL AUTO_INCREMENT,
  `idRest` varchar(255) DEFAULT NULL,
  `idAdmin` int DEFAULT NULL,
  `First_name` varchar(255) NOT NULL,
  `Last_name` varchar(255) NOT NULL,
  `address` varchar(255) NOT NULL,
  `phoneNo` varchar(255) NOT NULL,
  `email` varchar(255) NOT NULL,
  `password` varchar(255) NOT NULL,
  `customerType` varchar(255) NOT NULL,
  `points` int NOT NULL,
  `personalIdentityNo` varchar(255) NOT NULL,
  `shippersStatus` enum('BUSY','IN-ProgressTransit','ARRIVED') DEFAULT NULL,
  `age` int NOT NULL,
  `userRole` enum('CUSTOMER','ADMIN','SHIPPERS') DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `idRest` (`idRest`),
  KEY `idAdmin` (`idAdmin`),
  CONSTRAINT `idAdmin` FOREIGN KEY (`idAdmin`) REFERENCES `user` (`id`) ON DELETE SET NULL ON UPDATE CASCADE,
  CONSTRAINT `idRest` FOREIGN KEY (`idRest`) REFERENCES `apprest` (`idApp`) ON DELETE SET NULL ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci

CREATE TABLE `service_placesrestorant` (
  `id` int NOT NULL AUTO_INCREMENT,
  `service_Places` varchar(255) NOT NULL,
  `service_idApp` varchar(255) DEFAULT NULL,
  `transportCost` double NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `service_Places_UNIQUE` (`service_Places`),
  KEY `service_idApp` (`service_idApp`),
  CONSTRAINT `service_idApp` FOREIGN KEY (`service_idApp`) REFERENCES `apprest` (`idApp`) ON DELETE SET NULL ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci

CREATE TABLE `restorant_tables` (
  `rtb_id` int NOT NULL AUTO_INCREMENT,
  `reservationId` int DEFAULT NULL,
  `tableName` varchar(255) NOT NULL,
  `noChairTable` int NOT NULL,
  `description` varchar(255) NOT NULL,
  `status` tinyint(1) NOT NULL,
  `tb_id` int DEFAULT NULL,
  PRIMARY KEY (`rtb_id`),
  UNIQUE KEY `tb_id_UNIQUE` (`tb_id`),
  KEY `reservationId` (`reservationId`),
  CONSTRAINT `reservationId` FOREIGN KEY (`reservationId`) REFERENCES `reservation` (`cR_id`) ON DELETE SET NULL ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci

CREATE TABLE `reservation` (
  `cR_id` int NOT NULL AUTO_INCREMENT,
  `customerId` int DEFAULT NULL,
  `reservationDescription` text NOT NULL,
  `reservationTime` time NOT NULL,
  `reservationDate` date NOT NULL,
  `rNoParticipants` int NOT NULL,
  PRIMARY KEY (`cR_id`),
  KEY `customerId` (`customerId`),
  CONSTRAINT `customerId` FOREIGN KEY (`customerId`) REFERENCES `user` (`id`) ON DELETE SET NULL ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci

CREATE TABLE `payment_methodrestaurant` (
  `id` int NOT NULL AUTO_INCREMENT,
  `payment_Methods` varchar(255) NOT NULL,
  `paymentIdApp` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`id`,`payment_Methods`),
  UNIQUE KEY `payment_Methods_UNIQUE` (`payment_Methods`),
  KEY `paymentIdApp` (`paymentIdApp`),
  CONSTRAINT `paymentIdApp` FOREIGN KEY (`paymentIdApp`) REFERENCES `apprest` (`idApp`) ON DELETE SET NULL ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci

CREATE TABLE `package_ordered` (
  `id` int NOT NULL,
  `statusOrderSession` enum('Pending','In-Progress','Processed') DEFAULT NULL,
  `shippersId` int DEFAULT NULL,
  `sessionPayment` int NOT NULL,
  `serviceId` int DEFAULT NULL,
  `servicePlacesRest` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `shippersId` (`shippersId`),
  KEY `serviceId_idx` (`serviceId`),
  KEY `servicePlacesRest_idx` (`servicePlacesRest`),
  CONSTRAINT `serviceId` FOREIGN KEY (`serviceId`) REFERENCES `service_placesrestorant` (`id`) ON DELETE SET NULL ON UPDATE CASCADE,
  CONSTRAINT `shippersId` FOREIGN KEY (`shippersId`) REFERENCES `user` (`id`) ON DELETE SET NULL ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci


CREATE TABLE `orders` (
  `oId` int NOT NULL AUTO_INCREMENT,
  `idShporta` int DEFAULT NULL,
  `idCustomer` int DEFAULT NULL,
  `orderPrize` double NOT NULL,
  `orderItems` int NOT NULL,
  `oStatus` enum('Cancelled','Pending','In_Progress','Processed') DEFAULT NULL,
  `oTimeConfirmed` datetime NOT NULL,
  `oTimeProcessed` datetime NOT NULL,
  `paymentMethodId` int DEFAULT NULL,
  `paymentMethodRest` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`oId`),
  KEY `idShporta` (`idShporta`),
  KEY `idCustomer` (`idCustomer`),
  KEY `paymentMethodId_idx` (`paymentMethodId`),
  KEY `paymentMethodRest_idx` (`paymentMethodRest`),
  KEY `pMethodRest_idx` (`paymentMethodId`,`paymentMethodRest`),
  CONSTRAINT `idCustomer` FOREIGN KEY (`idCustomer`) REFERENCES `user` (`id`) ON DELETE SET NULL ON UPDATE CASCADE,
  CONSTRAINT `idShporta` FOREIGN KEY (`idShporta`) REFERENCES `package_ordered` (`id`) ON DELETE SET NULL ON UPDATE CASCADE,
  CONSTRAINT `paymentMethodId` FOREIGN KEY (`paymentMethodId`) REFERENCES `payment_methodrestaurant` (`id`) ON DELETE SET NULL ON UPDATE CASCADE,
  CONSTRAINT `pMethodRest` FOREIGN KEY (`paymentMethodId`, `paymentMethodRest`) REFERENCES `payment_methodrestaurant` (`id`, `payment_Methods`) ON DELETE SET NULL ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci

CREATE TABLE `dishcategory` (
  `dishType` varchar(255) NOT NULL,
  `dishCategoryId` int NOT NULL AUTO_INCREMENT,
  `dishId` int DEFAULT NULL,
  `cId` int DEFAULT NULL,
  PRIMARY KEY (`dishCategoryId`),
  KEY `dishId` (`dishId`),
  KEY `cId` (`cId`),
  CONSTRAINT `cId` FOREIGN KEY (`cId`) REFERENCES `user` (`id`),
  CONSTRAINT `dishId` FOREIGN KEY (`dishId`) REFERENCES `dish` (`id`) ON DELETE SET NULL ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci

CREATE TABLE `dish` (
  `id` int NOT NULL AUTO_INCREMENT,
  `adminId` int DEFAULT NULL,
  `orderId` int DEFAULT NULL,
  `dishName` varchar(255) NOT NULL,
  `dishPrize` int NOT NULL,
  `dishDescription` text NOT NULL,
  PRIMARY KEY (`id`),
  KEY `orderId` (`orderId`),
  KEY `adminId` (`adminId`),
  CONSTRAINT `adminId` FOREIGN KEY (`adminId`) REFERENCES `user` (`id`) ON DELETE SET NULL ON UPDATE CASCADE,
  CONSTRAINT `orderId` FOREIGN KEY (`orderId`) REFERENCES `orders` (`oId`) ON DELETE SET NULL ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci

CREATE TABLE `cards` (
  `BankId` varchar(255) NOT NULL,
  `valid_from` date NOT NULL,
  `expiredTime` date NOT NULL,
  `cardSecurityCode` int NOT NULL,
  `userCardId` int DEFAULT NULL,
  PRIMARY KEY (`BankId`),
  KEY `userCardId_idx` (`userCardId`),
  CONSTRAINT `userCardId` FOREIGN KEY (`userCardId`) REFERENCES `user` (`id`) ON DELETE SET NULL ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci

CREATE TABLE `apprest` (
  `idApp` varchar(255) NOT NULL,
  `appName` varchar(255) NOT NULL,
  `serialNo` mediumtext NOT NULL,
  `restNUIS` varchar(255) NOT NULL,
  `restName` varchar(255) NOT NULL,
  `phoneNo` varchar(255) NOT NULL,
  `addressRest` varchar(255) NOT NULL,
  `activity_field` text NOT NULL,
  `service_Places` varchar(255) NOT NULL,
  `payment_Methods` varchar(255) NOT NULL,
  `TimeServiceDay` varchar(255) NOT NULL,
  `restorant_tbId` int DEFAULT NULL,
  PRIMARY KEY (`idApp`),
  UNIQUE KEY `UNIQUE` (`restNUIS`),
  KEY `restorant_tbId_idx` (`restorant_tbId`),
  CONSTRAINT `restorant_tbId` FOREIGN KEY (`restorant_tbId`) REFERENCES `restorant_tables` (`rtb_id`) ON DELETE SET NULL ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci

CREATE TABLE `addinbasket` (
  `addId` int NOT NULL AUTO_INCREMENT,
  `custId` int DEFAULT NULL,
  `IDdish` int DEFAULT NULL,
  `addItemsDish` int NOT NULL,
  PRIMARY KEY (`addId`),
  KEY `custId` (`custId`),
  KEY `IDdish` (`IDdish`),
  CONSTRAINT `custId` FOREIGN KEY (`custId`) REFERENCES `user` (`id`) ON DELETE SET NULL ON UPDATE CASCADE,
  CONSTRAINT `IDdish` FOREIGN KEY (`IDdish`) REFERENCES `dish` (`id`) ON DELETE SET NULL ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci






